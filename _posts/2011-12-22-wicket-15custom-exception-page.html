---
layout: post
title: Wicket 1.5–Custom Exception Page
date: '2011-12-21T15:02:00.000-08:00'
author: Wizche
tags:
- java wicket web tomcat programming coding jee
modified_time: '2011-12-22T06:07:34.360-08:00'
thumbnail: http://lh3.ggpht.com/-aZhklHv9U2c/TvJlBoPG9wI/AAAAAAAAA-M/MR4WqRcgUHk/s72-c/image_thumb%25255B2%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-6991263519641111952.post-5372786022551714844
blogger_orig_url: http://blog.wizche.ch/2011/12/wicket-15custom-exception-page.html
---

<p>I’m building a web application using Wicket for the first time (which is <strong>really</strong> cool by the way). I’d like that all uncaught RuntimeExceptions are displayed in a custom exception page which permit the user to submit the error report to myself.<br><br>I had no luck searching for a simple example that explains how to redirect a user to a custom page when an exception happens. (at least not for Wicket v1.5).<br><br>Following the description in the <a href="https://cwiki.apache.org/WICKET/migration-to-wicket-15.html#MigrationtoWicket1.5-Exceptionhandling">Wicket Migration Guide</a> I came out with my own own code.<br><br>1) You have to add an <a href="http://wicket.apache.org/apidocs/1.5/org/apache/wicket/request/cycle/AbstractRequestCycleListener.html">AbstractRequestCycleListener</a> to your WebApplication constructor and override the onException method.</p> <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:f6960020-1bfb-46e4-a281-f0b32439807d" class="wlWriterEditableSmartContent"><pre name="code" class="ruby">public class TestApplication extends WebApplication {<br /><br />  /**<br />   * Constructor<br />   */<br />  public TestApplication() {<br />	  <br />	  // In case of unhandled exception redirect it to a custom page<br />	  this.getRequestCycleListeners().add(new AbstractRequestCycleListener() {<br />		  @Override<br />	      public IRequestHandler onException(RequestCycle cycle, Exception e) {<br />			  return new RenderPageRequestHandler(new PageProvider(new ExceptionPage(e)));<br />		  }<br />	  });<br />  }<br /><br />  public Class&lt;HomePage&gt; getHomePage() {<br />    return HomePage.class;<br />  }<br /><br />}</pre></div><br /><p>2) Prepare the exception page, in my case I would like to fill out a form automatically with all exception information's (like full stacktrace) and let the user submit it.<br><br>My ExceptionPage.java looks like this:<br><br /><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:b8f1f803-784f-4269-9e92-8c927505bd75" class="wlWriterEditableSmartContent"><pre name="code" class="java">public class ExceptionPage extends WebPage {<br /><br />	private static final long serialVersionUID = 593717625018028083L;<br /><br />	// My model for the form data<br />	FormExceptionProvider formProvider;<br />	<br />	// Mapped wicket:id <br />	private static final String wicketIdformSendException="formSendException";<br />	private static final String wicketIdformTarget="formTarget";<br />	private static final String wicketIdformComments="formComments";<br />	private static final String wicketIdmessageDetails="messageDetails";<br />	private static final String wicketIdsubmitForm="submitForm";<br /><br />	public ExceptionPage(Exception e) {<br />		formProvider = new FormExceptionProvider();<br />		formProvider.setTarget("Administrator");<br />		formProvider.setComments("Please provide here any useful information...");<br />		StringBuilder sb = new StringBuilder();<br />		sb.append(e.getClass().toString()+"\n");<br />		// Get the full stacktrace from exception and append to the string<br />		// Thanks to ripper234 (ref: http://stackoverflow.com/questions/1292858/getting-full-string-stack-trace-including-inner-exception)<br />		sb.append(joinStackTrace(e));<br />		// Add fullstacktrace as a form's field (readonly)<br />		formProvider.setAdditional(sb.toString());<br />		add(makeExceptionForm());<br />	}<br /><br />	private Form&lt;?&gt; makeExceptionForm() {<br /><br />		Form&lt;?&gt; form = new Form&lt;Void&gt;(wicketIdformSendException);<br /><br />		FormComponent&lt;?&gt; tfTarget = new TextField&lt;String&gt;(<br />				wicketIdformTarget, new PropertyModel&lt;String&gt;(<br />						formProvider, "target"));<br />		form.add(tfTarget);<br />	<br />		FormComponent&lt;?&gt; taComments = new TextArea&lt;String&gt;(wicketIdformComments, new PropertyModel&lt;String&gt;(formProvider, "comments"));<br />		form.add(taComments);<br /><br />		FormComponent&lt;?&gt; taAdditional = new TextArea&lt;String&gt;(wicketIdmessageDetails, new PropertyModel&lt;String&gt;(formProvider, "additional"));<br />		form.add(taAdditional);<br /><br />		form.add(new Button(wicketIdsubmitForm) {<br />			private static final long serialVersionUID = -3553700128326728526L;<br /><br />			@Override<br />			public void onSubmit() {<br />				/* <br />				 * Do your stuff here (i.e. Send Email)<br />				 */<br />			}<br />		});<br />		return form;<br />	}<br />	<br />	public static String joinStackTrace(Throwable e) {<br />	    StringWriter writer = null;<br />	    try {<br />	        writer = new StringWriter();<br />	        joinStackTrace(e, writer);<br />	        return writer.toString();<br />	    }<br />	    finally {<br />	        if (writer != null)<br />	            try {<br />	                writer.close();<br />	            } catch (IOException e1) {<br />	                // ignore<br />	            }<br />	    }<br />	}<br /><br />	public static void joinStackTrace(Throwable e, StringWriter writer) {<br />	    PrintWriter printer = null;<br />	    try {<br />	        printer = new PrintWriter(writer);<br /><br />	        while (e != null) {<br /><br />	            printer.println(e);<br />	            StackTraceElement[] trace = e.getStackTrace();<br />	            for (int i = 0; i &lt; trace.length; i++)<br />	                printer.println("\tat " + trace[i]);<br /><br />	            e = e.getCause();<br />	            if (e != null)<br />	                printer.println("Caused by:\r\n");<br />	        }<br />	    }<br />	    finally {<br />	        if (printer != null)<br />	            printer.close();<br />	    }<br />	}<br />}</pre></div><br>And the related HTML code:<br><br /><div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:812469c5-0cb0-4c63-8c15-c81123a09de7:fcd8cad9-c155-47d9-99be-286115ef9113" class="wlWriterEditableSmartContent"><pre name="code" class="xml">&lt;html&gt;<br />&lt;head&gt;<br />&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"&gt;<br />&lt;title&gt;Exception Page&lt;/title&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />&lt;form wicket:id="formSendException"&gt;<br />	&lt;table&gt;<br />	  &lt;tr&gt;<br />	    &lt;td width="100" align="right" &gt;Target&lt;/td&gt;<br />	    &lt;td&gt;&lt;input wicket:id="formTarget" type="text" size="20" value="admin@unizh.ch"  readonly="readonly"/&gt;&lt;/td&gt;<br />	  &lt;/tr&gt;<br />	  &lt;tr&gt;<br />	   &lt;td width="100" align="right" &gt;Comments:&lt;/td&gt;<br />	    &lt;td&gt;&lt;textarea wicket:id="formComments" rows="10" cols="50"&gt;&lt;/textarea&gt;&lt;/td&gt;<br />	  &lt;/tr&gt;<br />	  &lt;tr&gt;<br />	   &lt;td width="100" align="right" &gt;Additional:&lt;/td&gt;<br />	   &lt;td&gt;&lt;textarea wicket:id="messageDetails" rows="20" cols="100" readonly="readonly"&gt;&lt;/textarea&gt;&lt;/td&gt;<br />	   &lt;/tr&gt;<br />	  &lt;tr&gt;<br />	    &lt;td&gt;&amp;nbsp;&lt;/td&gt;<br />	    &lt;td align="left"&gt;&lt;button wicket:id="submitForm" type="submit"&gt;Submit Report&lt;/button&gt;&lt;/td&gt;<br />	    &lt;td&gt;&amp;nbsp;&lt;/td&gt;<br />	  &lt;/tr&gt;<br />	&lt;/table&gt;<br />&lt;/form&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;</pre></div><br>I didn’t cared much (yet) about the UI, I was just looking to build something quick and useful for submitting error reports. An example of the resulting page is shown here:<br><br><a href="http://lh4.ggpht.com/-RZyfpT4m5UE/TvJlA5U2rjI/AAAAAAAAA-E/wY81yEAviZA/s1600-h/image%25255B4%25255D.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/-aZhklHv9U2c/TvJlBoPG9wI/AAAAAAAAA-M/MR4WqRcgUHk/image_thumb%25255B2%25255D.png?imgmax=800" width="603" height="380"></a><br><br>Hope it helps! </p>  