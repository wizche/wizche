---
layout: post
title: Home VPN – Consideration on bandwidth and IPSec overhead
date: '2010-03-08T11:25:00.000-08:00'
author: Wizche
tags:
- vpn ipsec esp overhead
modified_time: '2010-03-08T11:31:55.643-08:00'
thumbnail: http://2.bp.blogspot.com/_cXYmdFluLpw/S5VNrOlevhI/AAAAAAAAAio/ib13NHPdQzw/s72-c/SSL-VPN.gif
blogger_id: tag:blogger.com,1999:blog-6991263519641111952.post-88783950341005336
blogger_orig_url: http://blog.wizche.ch/2010/03/home-vpn-consideration-on-bandwidth-and.html
---

<meta content="Word.Document" name="ProgId"></meta><meta content="Microsoft Word 12" name="Generator"></meta><meta content="Microsoft Word 12" name="Originator"></meta><link href="file:///C:%5CUsers%5CWizche%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_filelist.xml" rel="File-List"></link><link href="file:///C:%5CUsers%5CWizche%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_themedata.thmx" rel="themeData"></link><link href="file:///C:%5CUsers%5CWizche%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_colorschememapping.xml" rel="colorSchemeMapping"></link><style>
 <!--
  /* Font Definitions */
  @font-face
 	{font-family:"Cambria Math";
 	panose-1:2 4 5 3 5 4 6 3 2 4;
 	mso-font-charset:0;
 	mso-generic-font-family:roman;
 	mso-font-pitch:variable;
 	mso-font-signature:-1610611985 1107304683 0 0 415 0;}
 @font-face
 	{font-family:Calibri;
 	panose-1:2 15 5 2 2 2 4 3 2 4;
 	mso-font-charset:0;
 	mso-generic-font-family:swiss;
 	mso-font-pitch:variable;
 	mso-font-signature:-520092929 1073786111 9 0 415 0;}
  /* Style Definitions */
  p.MsoNormal, li.MsoNormal, div.MsoNormal
 	{mso-style-unhide:no;
 	mso-style-qformat:yes;
 	mso-style-parent:"";
 	margin-top:0cm;
 	margin-right:0cm;
 	margin-bottom:10.0pt;
 	margin-left:0cm;
 	line-height:115%;
 	mso-pagination:widow-orphan;
 	font-size:11.0pt;
 	font-family:"Calibri","sans-serif";
 	mso-fareast-font-family:Calibri;
 	mso-bidi-font-family:"Times New Roman";
 	mso-fareast-language:EN-US;}
 .MsoChpDefault
 	{mso-style-type:export-only;
 	mso-default-props:yes;
 	font-size:10.0pt;
 	mso-ansi-font-size:10.0pt;
 	mso-bidi-font-size:10.0pt;
 	mso-ascii-font-family:Calibri;
 	mso-fareast-font-family:Calibri;
 	mso-hansi-font-family:Calibri;}
 @page Section1
 	{size:612.0pt 792.0pt;
 	margin:70.85pt 2.0cm 2.0cm 2.0cm;
 	mso-header-margin:36.0pt;
 	mso-footer-margin:36.0pt;
 	mso-paper-source:0;}
 div.Section1
 	{page:Section1;}
 -->
 </style>  <br /><a href="http://2.bp.blogspot.com/_cXYmdFluLpw/S5VNrOlevhI/AAAAAAAAAio/ib13NHPdQzw/s1600-h/SSL-VPN.gif" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="100" src="http://2.bp.blogspot.com/_cXYmdFluLpw/S5VNrOlevhI/AAAAAAAAAio/ib13NHPdQzw/s200/SSL-VPN.gif" width="200" /></a><span style="font-family: Verdana,sans-serif;">I was considering to implement a VPN solution for accessing my home network, more for the NAS (Network Attached Storage) I’ve recently buyed, nowadays I reach it directly (via NAT) from my public IP (obviously I had to build some kind of filtering).</span><br /><div style="font-family: Verdana,sans-serif;"><br />I’ve an ADSL connection with 5000 Kbit/s in download and 300 Kbit/s in upload… I’m going to focus on the upload part because is my bottleneck.</div><div style="font-family: Verdana,sans-serif;">Installing a VPN solution isn’t that difficult, but with a limited bandwidth which drawback will it brings?</div><div style="font-family: Verdana,sans-serif;"><br /></div><div style="font-family: Verdana,sans-serif;"></div><div style="font-family: Verdana,sans-serif;"><a href="http://2.bp.blogspot.com/_cXYmdFluLpw/S5VOd5HTiKI/AAAAAAAAAiw/uYkZ2Ms4uRk/s1600-h/esptunnelmode.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="120" src="http://2.bp.blogspot.com/_cXYmdFluLpw/S5VOd5HTiKI/AAAAAAAAAiw/uYkZ2Ms4uRk/s320/esptunnelmode.png" width="320" /></a> Now considering an IPSec VPN solution, using ESP in Tunnel mode (full IP packet is protected), the IPSec will add a new IP header, an ESP header, an ESP Trailer and an ESP ICV.</div><div style="font-family: Verdana,sans-serif;"><br /></div><div style="font-family: Verdana,sans-serif;">&nbsp;The overhead generated by IPSec is about of 50-60 bytes per packet (depending on the authentication/encryption /hash used). For my calculation I’ll take <u>60 bytes overhead as reference</u>.</div><div style="font-family: Verdana,sans-serif;"><br /></div><div style="font-family: Verdana,sans-serif;">Normally I can reach a packet upload rate of about 25 packets per second:</div><div style="font-family: Verdana,sans-serif;"></div><div style="font-family: Verdana,sans-serif;">37.5 Kbytes (=300kbits) / 1.5 Kbyte (max IP packet size) = 25 packets/second</div><div style="font-family: Verdana,sans-serif;"><br /></div><div style="font-family: Verdana,sans-serif;">If IPSec is used, my packet rate will fall down to:</div><div style="font-family: Verdana,sans-serif;"></div><div style="font-family: Verdana,sans-serif;">37.5 Kbytes / 1.560 Kbyte (IP Packet + ESP overhead) = ~ 24 packets/second</div><div style="font-family: Verdana,sans-serif;"><br /></div><div style="font-family: Verdana,sans-serif;">Maybe its easier to see it with a percent notation. Estimating a packet size of 1500 bytes this correspond to a loss of 60 bytes who is equal to <b>4 % of bandwidth lost</b>. What's also to be considered is that the percent varies with the variation of IP packet size, as said before 1500 bytes is the maximal size but, if for example the packets sent are just 1’000 bytes, the overhead is more marked with a decrease of bandwidth to <b>6% lesser then without VPN</b>.<br /><br />So, in conclusion, this will cost me a loss of about 1500 bytes per second, considering the protection that IPSec brings I think is a price worth to pay (In fact I had about 10k bruteforce attack on the NAS in less than a month!).</div><br /><div class="MsoNormal"><span lang="EN-US"></span></div><div class="MsoNormal"><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><meta content="Word.Document" name="ProgId"></meta><meta content="Microsoft Word 12" name="Generator"></meta><meta content="Microsoft Word 12" name="Originator"></meta><link href="file:///C:%5CUsers%5CWizche%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_filelist.xml" rel="File-List"></link><link href="file:///C:%5CUsers%5CWizche%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_editdata.mso" rel="Edit-Time-Data"></link><link href="file:///C:%5CUsers%5CWizche%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_themedata.thmx" rel="themeData"></link><link href="file:///C:%5CUsers%5CWizche%5CAppData%5CLocal%5CTemp%5Cmsohtmlclip1%5C01%5Cclip_colorschememapping.xml" rel="colorSchemeMapping"></link><style>
 <!--
  /* Font Definitions */
  @font-face
 	{font-family:"Cambria Math";
 	panose-1:2 4 5 3 5 4 6 3 2 4;
 	mso-font-charset:0;
 	mso-generic-font-family:roman;
 	mso-font-pitch:variable;
 	mso-font-signature:-1610611985 1107304683 0 0 415 0;}
 @font-face
 	{font-family:Calibri;
 	panose-1:2 15 5 2 2 2 4 3 2 4;
 	mso-font-charset:0;
 	mso-generic-font-family:swiss;
 	mso-font-pitch:variable;
 	mso-font-signature:-520092929 1073786111 9 0 415 0;}
  /* Style Definitions */
  p.MsoNormal, li.MsoNormal, div.MsoNormal
 	{mso-style-unhide:no;
 	mso-style-qformat:yes;
 	mso-style-parent:"";
 	margin-top:0cm;
 	margin-right:0cm;
 	margin-bottom:10.0pt;
 	margin-left:0cm;
 	line-height:115%;
 	mso-pagination:widow-orphan;
 	font-size:11.0pt;
 	font-family:"Calibri","sans-serif";
 	mso-fareast-font-family:Calibri;
 	mso-bidi-font-family:"Times New Roman";
 	mso-fareast-language:EN-US;}
 .MsoChpDefault
 	{mso-style-type:export-only;
 	mso-default-props:yes;
 	font-size:10.0pt;
 	mso-ansi-font-size:10.0pt;
 	mso-bidi-font-size:10.0pt;
 	mso-ascii-font-family:Calibri;
 	mso-fareast-font-family:Calibri;
 	mso-hansi-font-family:Calibri;}
 @page Section1
 	{size:612.0pt 792.0pt;
 	margin:70.85pt 2.0cm 2.0cm 2.0cm;
 	mso-header-margin:36.0pt;
 	mso-footer-margin:36.0pt;
 	mso-paper-source:0;}
 div.Section1
 	{page:Section1;}
 -->
 </style><span style="font-family: &quot;Calibri&quot;,&quot;sans-serif&quot;; font-size: 11pt; line-height: 115%;"></span></div>