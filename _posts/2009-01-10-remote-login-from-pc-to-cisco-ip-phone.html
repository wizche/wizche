---
layout: post
title: Remote login from PC to a Cisco IP Phone using Extension Mobility API
date: '2009-01-10T09:50:00.001-08:00'
author: Wizche
tags: 
modified_time: '2009-01-20T15:15:39.705-08:00'
blogger_id: tag:blogger.com,1999:blog-6991263519641111952.post-2825803278612965309
blogger_orig_url: http://blog.wizche.ch/2009/01/remote-login-from-pc-to-cisco-ip-phone.html
---

Hi,<br /><br />I wrote down a small function to login on my IP Phone from the PC sending a POST string to the CallManager (with Extension Mobility) using the HttpWebRequest object...<br /><br />Take a look to <a href="http://www.cisco.com/en/US/docs/voice_ip_comm/cucm/devguide/em_api/4_1_2/emapich2.pdf">"Cisco Extension Mobility API"</a> and please check upper/lower case in the post string of code below... something can be wrong! <div><br /><pre class="Cpp" name="code"><br />private static void PostToService()<br />{<br />    bool ERROR = false;<br />    <br />    // Our string to be posted<br />    // I used AppSettings to store my userID, pincode and phoneaddress<br />    // You can change this as your desire<br />    byte[] buffer = Encoding.ASCII.GetBytes("xml=<request><appInfo><appID>"+ConfigurationManager.AppSettings["userID"]+"</appID><appCertificate>"+ConfigurationManager.AppSettings["pincode"]+"</appCertificate></appInfo><login><deviceName>"+ConfigurationManager.AppSettings["phoneaddress"]+"</deviceName><userID>"+ConfigurationManager.AppSettings["userID"]+"</userID></login></request>");<br />    <br />    // HERE change A.B.C.D with the ip of your Call Manager<br />    // ATTENTION there's no connection test, if cannot connect to server, it crash!<br />    HttpWebRequest WebReq = (HttpWebRequest)WebRequest.Create("http://A.B.C.D/emservice/EMServiceServlet");<br />    WebReq.Method = "POST";<br />    WebReq.ContentType = "application/x-www-form-urlencoded";<br />    WebReq.ContentLength = buffer.Length;<br />    Stream PostData = WebReq.GetRequestStream();<br />    PostData.Write(buffer, 0, buffer.Length);<br />    PostData.Close();<br />    HttpWebResponse WebResp = (HttpWebResponse)WebReq.GetResponse();<br />    Console.WriteLine(WebResp.StatusCode);<br />    Console.WriteLine(WebResp.Server);<br />    Stream Answer = WebResp.GetResponseStream();<br />    StreamReader _Answer = new StreamReader(Answer);<br /><br />    /* Response interpretation */<br />    try<br />    {<br />        XmlTextReader objXmlTextReader = new XmlTextReader(Answer);<br />        <br />        while (objXmlTextReader.Read())<br />        {<br />            switch (objXmlTextReader.NodeType)<br />            {<br />                case XmlNodeType.Element: <br />                    switch (objXmlTextReader.Name)<br />                    {<br />                        case "success":<br />                            Console.WriteLine("==> Login successfully <==");<br />                            break;<br />                        case "failure":<br />                            Console.WriteLine("==> Login Failed <==");<br />                            ERROR = true;<br />                            break;<br />                    }<br /><br />                    while (objXmlTextReader.MoveToNextAttribute()) <br />                        if (ERROR == true)<br />                        {<br />                            Console.Write("Error code: " + objXmlTextReader.Value + "\n");<br />                         }<br />                    break;<br />                case XmlNodeType.Text:<br />                    if (ERROR)<br />                    {<br />                        Console.Write("Error Message: ");<br />                        Console.Write(objXmlTextReader.Value + "\n");<br />                    }<br />                    break;<br />            }<br />        }<br />    }<br />    catch (Exception ex)<br />    {<br />        Console.WriteLine("==> Error Parsing Output <==");<br />        Console.WriteLine(ex.ToString());<br />    }<br />    Answer.Close();<br />    <br />    Console.WriteLine("Disconnected");<br />} <br /></pre></div>